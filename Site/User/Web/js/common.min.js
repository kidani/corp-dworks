/*!
 * 共通処理
 *
 * @author     : kidani@wd-valley.com
 * @copyright  : Wood Valley Co., Ltd.
 *
 */
;function getParamList(){var d=location.search;d=d.substring(1,d.length);var a=decodeURIComponent(d).split("&");var b={};for(var c in a){if(a[c].match(/^([^=]+)=(.*)$/)){b[RegExp.$1]=RegExp.$2}}return b}function getParam(b){var a=getParamList();if(a[b]){return a[b]}}function buildQuery(b,c){var a=$.extend(true,{},b);if(c){if(a[c]){delete a[c]}}return $.param(a)}function getQuery(b){var a=location.search;a=a.substring(1);if(b){reg=new RegExp("&*"+b+"=[^&]+","g");a=a.replace(reg,"")}reg=new RegExp("^&");a=a.replace(reg,"");return a}function serverLog(c,d,b){var a;$.ajax({url:"/?p=ServerLog",type:"POST",data:{detail:c,title:d,file:b},dataType:"json",async:true,timeout:10000}).done(function(f,e,g){if(!f){console.error("serverLog実行エラー")}a=f}).fail(function(g,e,f){console.error("serverLog実行エラー（通信エラー）")}).always(function(g,e,f){});return a}function hasZenkaku(b){var a=0;b=escape(b);for(i=0;i<b.length;i++,a++){if(b.charAt(i)==="%"){if(b.charAt(++i)==="u"){return true}i++}}return false}function isZenkakuKanaOnly(a){if(!a){return false}if(a.match(/^[ァ-ヶー]*$/)){return true}else{return false}}function countCharLength(d){var b=0;for(var a in d){var e=d.charCodeAt(a);if((e>=0&&e<129)||(e===63728)||(e>=65377&&e<65440)||(e>=63729&&e<63732)){b+=1}else{b+=2}}return b}function jstrlen(b){var a=0;b=escape(b);for(i=0;i<b.length;i++,a++){if(b.charAt(i)==="%"){if(b.charAt(++i)==="u"){i+=3;a++}i++}}return a}String.prototype.jtrim=function(){return this.replace(/^[\s　]+|[\s　]+$/g,"")};String.prototype.ltrim=function(){return this.replace(/^[\s　]+/g,"")};String.prototype.rtrim=function(){return this.replace(/[\s　]+$/g,"")};String.prototype.lftrim=function(){return this.replace(/\r?\n/g,"")};function getPathInfo(a){var b=[];b.dirName=a.substring(0,a.lastIndexOf("/")+1);b.baseName=a.substring(a.lastIndexOf("/")+1,a.length);b.filename=b.baseName.substring(0,b.baseName.indexOf("."));b.extension=b.baseName.substring(b.baseName.lastIndexOf(".")+1,b.baseName.length);return b}function getDirName(b){var a=getPathInfo(b);return a.dirName}function getBaseName(b){var a=getPathInfo(b);return a.baseName}function getFileName(b){var a=getPathInfo(b);return a.fileName}function getExtName(b){var a=getPathInfo(b);return a.extension}function replaceExtName(b,a){dir=getDirName(b);file=getFileName(b);return dir+file+"."+a}function deleteNameTail(c,b){var a=c.split("?");b=b.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");reg=new RegExp(b+"(.\\w+)$");return a[0].replace(reg,"$1")}function addNameTail(c,b){var a=c.split("?");b=b.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");reg=new RegExp("(.\\w+)$");return a[0].replace(reg,b+"$1")}function getImagePath(c,b){var d=c.attr("src");var a=[];if(!b){a=d.split("?")}else{a[0]=d}return a[0]}function replaceLink(a,b,c){$.each(a,function(e,d){var f=d.href;d.href=f.replace(b,c)})}function formatDate(c){var e=c.getFullYear();var f=("0"+(c.getMonth()+1)).slice(-2);var b=("0"+c.getDate()).slice(-2);var a=("0"+c.getHours()).slice(-2);var d=("0"+c.getMinutes()).slice(-2);return e+"/"+f+"/"+b+" "+a+":"+d}function wvValidateForm(a,b){$result=true;$.each(a,function(c,d){if(!wvValidate(c,d,b)){$result=false;console.log("チェック結果失敗："+c+" - "+d)}else{console.log("チェック結果成功："+c+" - "+d)}});return $result}function wvValidate(a,d,e){var b;var c=$("[name="+a+"]");if(!c.length){c=$("[name='"+a+"[]']")}if(!c.length){return true}$.each(d,function(p,q){var m;if(c[0]){m=c[0].type}var k;var o;if(m==="text"||m==="textarea"||m==="password"||m==="number"){k=c.val();k=k.ltrim();c.val(k);o=k.length}else{if(m==="select-one"){k=c.val()}else{if(m==="checkbox"){var k;$targetCheck=$("[name='"+a+"[]']");if($targetCheck.length){k=$("[name='"+a+"[]']:checked").val()}else{$targetCheck=$("[name='"+a+"']");k=$("[name='"+a+"']:checked").val()}}else{if(m==="radio"){k=$("[name="+a+"]:checked").val();if(k===undefined){k=null}}else{serverLog(c,"フォーム部品のタイプ不正検知")}}}}if(q==="require"){if(!k){b="必須入力です";setErrorMessage(c,b);return false}}else{if(!k){return false}}var g=null;if(g=q.match(/^max([0-9]+)$/)){var j=parseInt(g[1]);if(o>j){b=j+"文字以内で入力して下さい。";setErrorMessage(c,b);return false}}if(g=q.match(/^min([0-9]+)$/)){var l=parseInt(g[1]);if(o<l){b=l+"文字以上で入力して下さい。";setErrorMessage(c,b);return false}}if(g=q.match(/^fix([0-9]+)$/)){var n=parseInt(g[1]);if(o!==n){b=n+"文字で入力して下さい。";setErrorMessage(c,b);return false}}if(q==="email"){if(!mailAddrCheck(k)){b="メールアドレスの形式が不正です。";setErrorMessage(c,b);return false}}if(q==="numOnly"){if(!k.match(/^(?:[0-9]+)*$/)){b="半角数字のみで入力して下さい。";setErrorMessage(c,b);return false}}if(q==="numDotOnly"){if(!k.match(/^(?:[.0-9]+)*$/)){b="半角数字と小数点のみで入力して下さい。";setErrorMessage(c,b);return false}}if(q==="numEnOnly"){if(!k.match(/^(?:[A-Za-z0-9]+)*$/)){b="半角英数字のみで入力して下さい。";setErrorMessage(c,b);return false}}if(g=q.match(/^numRangeMin([0-9]+)$/)){var f=parseInt(g[1]);if(parseInt(k)<f){b=f+"以上を入力して下さい。";setErrorMessage(c,b);return false}}if(g=q.match(/^numRangeMax([0-9]+)$/)){var h=parseInt(g[1]);if(parseInt(k)>h){b=h+"以下を入力して下さい。";setErrorMessage(c,b);return false}}if(q==="year"){}if(q==="month"){if(parseInt(k)<1||parseInt(k)>12){b="月が不正です。";setErrorMessage(c,b);return false}}if(q==="zenKanaOnly"){if(!isZenkakuKanaOnly(k)){b="全角カナのみで入力して下さい。";setErrorMessage(c,b);return false}}});if(!b&&e){b=e(a,b)}if(b){return false}else{clearErrorMessage(c)}return true}function addValidateEvent(a,b){$.each(a,function(d,f){var c=$("[name="+d+"]");if(!c.length){c=$("[name='"+d+"[]']")}if(!c.length){return}c.on("blur change ",function(){if(wvValidate(d,f,b)){}});var e=c[0].type;if(e==="text"||e==="password"||e==="textarea"||e==="number"){$(function(){c.each(function(){$(this).bind("keyup",checkChangeValue(this,f,b))})})}})}function deleteValidateEvent(a){$.each(a,function(b,d){var c=$("[name="+b+"]");c.unbind()})}function checkChangeValue(c,d,e){var b,a=c.value;return function(){b=c.value;if(a!==b){a=b;wvValidate(c.name,d,e)}}}function mailAddrCheck(a){if(!a.match(/^[\.!#%&\-_0-9a-zA-Z\?\/\+]+\@[!#%&\-_0-9a-z]+(\.[!#%&\-_0-9a-z]+)+$/)){return false}return true}function validateStartEndTime(){var a=$("[name=startTime]");var d=$("[name=endTime]");clearErrorMessage(a);clearErrorMessage(d);var c=a.val();var b=d.val();if(c&&!b){setArrowMessage(d,"終了時間を選択して下さい。");return false}else{if(!c&&b){setArrowMessage(a,"開始時間を選択して下さい。");return false}}if(c&&c===b){setArrowMessage(d,"開始時間と終了時間が同じです。");return false}if(c>b){setArrowMessage(d,"終了時間が開始時間より前です。");return false}return true}function setErrorMessage(d,b){var a=d[0].type;if(a==="checkbox"||a==="radio"){d.parent().addClass("wvInvalid")}else{d.addClass("wvInvalid")}var c=d.parents(".form-group");var e=$(".formErrorMessage",c);if(e.length){e.text(b);e.show()}else{d.after('<div class="formErrorMessage"></div>');e=d.next(".formErrorMessage");e.text(b);e.show()}}function clearErrorMessage(c){var a=c[0].type;if(a==="checkbox"||a==="radio"){c.parent().removeClass("wvInvalid")}else{c.removeClass("wvInvalid")}var d=c.next(".formErrorMessage");if(!d.length){var b=c.parents(".form-group");d=$(".formErrorMessage",b)}if(d.length){d.text("");d.hide()}}function wvValidateCheckbox(a){var b=false;a.each(function(c,d){if($(d).prop("checked")===true){b=true;return false}});if(!b){return false}return true}function setArrowMessage(d,c){var a;if(!d.next(".arrow-box").length){d.after('<span class="arrow-box"></span>');a=d.next(".arrow-box");var f=d.offset();var e=f.left;var b=f.top+d.outerHeight()+10;a.css("z-index",1000);a.css("color","yellow");a.css("display","inline-block");a.offset({top:b,left:e});a.text(c)}else{a=d.next(".arrow-box");a.text(c);a.css("display","inline-block")}d.next(".arrow-box").on("click",function(){clearErrorMessage(d)})}$(function(){var a=$(".pop-help");a.click(function(){openHelpMessage($(this))});a.on("mouseover",function(){openHelpMessage($(this))});$arrowBox=$(".arrow-box");$arrowBox.click(function(){$(this).hide()});$arrowBox.on("mouseleave",function(){$(this).hide()})});function openHelpMessage(d){var b=d.next(".arrow-box");if(!b.length){b=d.parent().next(".arrow-box")}var a={};a.left=parseInt(b.attr("left")?b.attr("left"):0);a.top=parseInt(b.attr("top")?b.attr("top"):0);if(b.css("display")==="block"){b.css("display","none")}else{var f=d.offset();var e=f.left-10+a.left;var c=f.top+d.outerHeight()+10+a.top;b.css("z-index",2000);b.css("display","inline-block");b.offset({top:c,left:e})}}function showGoogleMap(g,a,j,c,d,h,l){var b=new google.maps.LatLng(g,a);if(d==="ROADMAP"){mapTypeId=google.maps.MapTypeId.ROADMAP}else{mapTypeId=google.maps.MapTypeId.SATELLITE}if(l===undefined){l=false}var k={zoom:j,center:b,mapTypeId:mapTypeId};var e=new google.maps.Map(document.getElementById(c),k);var f=new google.maps.Marker({map:e,position:b,title:h,draggable:l,icon:new google.maps.MarkerImage("images/marker_finger.png",new google.maps.Size(48,48),new google.maps.Point(0,0),new google.maps.Point(48,0))});if($('[name="latitude"]').length){google.maps.event.addListener(f,"dragend",function(m){$('[name="latitude"]').val(m.latLng.lat());$('[name="longitude"]').val(m.latLng.lng())})}if($('[name="zoom"]').length){google.maps.event.addListener(e,"zoom_changed",function(){$('[name="zoom"]').val(e.getZoom())})}}function callbackRender(d,b){if(b==google.maps.GeocoderStatus.OK){var c={zoom:18,center:d[0].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP};var e=new google.maps.Map(document.getElementById("map-canvas"),c);var a=new google.maps.Marker({map:e,position:d[0].geometry.location,title:"XXXXX",draggable:true,icon:new google.maps.MarkerImage("images/marker_finger.png",new google.maps.Size(48,48),new google.maps.Point(0,0),new google.maps.Point(48,0))});var f=d[0].geometry.location;$('[name="latitude"]').val(f.lat());$('[name="longitude"]').val(f.lng());$('[name="zoom"]').val(e.getZoom());google.maps.event.addListener(a,"dragend",function(g){$('[name="latitude"]').val(g.latLng.lat());$('[name="longitude"]').val(g.latLng.lng())});google.maps.event.addListener(e,"zoom_changed",function(){$('[name="zoom"]').val(e.getZoom())})}}$(function(){$(".confirmRegist").on("click",function(c){var a=$(this).next("span").text();if(!a){a=$(this).next("div").text()}if(!a){a="登録していいですか？"}var b=confirm(a);if(b!==true){return false}$("#loading").fadeIn()});$(".confirmDelete").on("click",function(b){var a=confirm("削除していいですか？");if(a!==true){return false}})});$(function(){$(".box-testInput .btn-test").on("click",function(e){var $self=$(this);var $testBox=$(".testInputVal",$(this).parent(".box-testInput"));$testBox.children("div").each(function(key,val){var targetKey=$(val).attr("data-name");var $targetObj=$('[name="'+targetKey+'"]');if(!$targetObj.length){return true}var partsType=$targetObj.attr("type");if(!partsType){partsType=$targetObj[0].type}var targetVal=$(val).text();if(!targetVal&&$(val).hasClass("targetBtnTest")){targetVal=$self.text()}if($targetObj){if(partsType==="checkbox"){$targetObj.val(eval(targetVal))}else{if(partsType==="radio"){$targetObj.val(eval('["'+targetVal+'"]'))}else{$targetObj.val(targetVal)}}}})})});